(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-fa5eb26c"],{"0584":function(s,e,t){},"9ed6":function(s,e,t){"use strict";t.r(e);var i=(t("d9e2"),t("c24f")),o=t("61f7"),a={name:"Login",directives:{focus:{inserted(s){s.querySelector("input").focus()}}},data(){return{qrcodeImage:"",nodeEnv:"production",loginType:1,title:this.$baseTitle,form:{loginName:"",password:""},rules:{username:[{required:!0,trigger:"blur",validator:(s,e,t)=>{""==e?t(new Error("用户名不能为空")):t()}}],password:[{required:!0,trigger:"blur",validator:(s,e,t)=>{Object(o.c)(e)?t():t(new Error("密码不能少于6位"))}}]},loading:!1,passwordType:"password",redirect:void 0,qrCode:""}},created(){document.body.style.overflow="hidden"},beforeDestroy(){document.body.style.overflow="auto"},mounted(){this.form.loginName="",this.form.password="",this.loginGetQrcode()},methods:{loginGetQrcode(){Object(i.c)().then((s=>{1==s.code&&(this.qrcodeImage=s.data.qrcodeImage,this.qrCode=s.data.qrcode,setTimeout((()=>{this.loginStatusCheck()}),2e3))}))},loginStatusCheck(){Object(i.d)(this.qrCode).then((s=>{if(1==s.code){const e=s;e.byPwd=!1,this.$store.dispatch("user/setCommonInfo",e).then((async(s,e)=>{if(1!=s.code)return this.$message.error(s.message),void(this.loading=!1);await this.$store.dispatch("routes/setAllRoutes"),window.sessionStorage.isAuth=!0,this.$router.push({path:"/specimen",query:{isAuth:!e||"",msg:e}}).catch((()=>{})),this.loading=!1})).catch((()=>{this.loading=!1}))}else 1==this.loginType&&setTimeout((()=>{1==this.loginType&&this.loginStatusCheck()}),2e3)}))},changeLoginType(s){this.loginType=s,1==this.loginType&&this.loginStatusCheck()},handlePassword(){"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((()=>{this.$refs.password.focus()}))},handleLogin(){this.$refs.form.validate((s=>{if(!s)return!1;{this.loading=!0;const s=JSON.parse(JSON.stringify(this.form));s.password=this.$md5(s.password),s.password=this.$md5(s.password),this.$store.dispatch("user/login",s).then((async s=>{if(1!=s.code)return this.$message.error(s.message),void(this.loading=!1);await this.$store.dispatch("routes/setAllRoutes"),console.log("登录页开始push specimen"),this.$router.push({path:"/specimen",query:{noAuth:!!s.errMsg||"",msg:s.errMsg}}).catch((()=>{})),this.loading=!1})).catch((()=>{this.loading=!1}))}}))}}},r=a,n=(t("ca48"),t("2877")),l=Object(n.a)(r,(function(){var s=this,e=s._self._c;return e("div",{staticClass:"login-wrap"},[e("div",{directives:[{name:"show",rawName:"v-show",value:2==s.loginType,expression:"loginType == 2"}],staticClass:"login-container"},[e("el-row",[e("el-col",{attrs:{xs:24,sm:24,md:12,lg:16,xl:14}},[e("div",{staticStyle:{color:"transparent"}},[s._v("占位符")])]),e("el-col",{attrs:{xs:24,sm:24,md:12,lg:9,xl:10}},[e("el-form",{ref:"form",staticClass:"login-form",attrs:{model:s.form,rules:s.rules,"label-position":"left"}},[e("div",{staticClass:"title"},[s._v(" hello ! ")]),e("div",{staticClass:"title-tips"},[s._v("欢迎来到"+s._s(s.title)+"！")]),e("el-form-item",{staticStyle:{"margin-top":"40px"},attrs:{prop:"username"}},[e("span",{staticClass:"svg-container svg-container-admin"},[e("vab-icon",{attrs:{icon:["fas","user"]}})],1),e("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请输入用户名",tabindex:"1",type:"text"},model:{value:s.form.loginName,callback:function(e){s.$set(s.form,"loginName","string"==typeof e?e.trim():e)},expression:"form.loginName"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("span",{staticClass:"svg-container"},[e("vab-icon",{attrs:{icon:["fas","lock"]}})],1),e("el-input",{key:s.passwordType,ref:"password",attrs:{type:s.passwordType,tabindex:"2",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&s._k(e.keyCode,"enter",13,e.key,"Enter")?null:s.handleLogin.apply(null,arguments)}},model:{value:s.form.password,callback:function(e){s.$set(s.form,"password","string"==typeof e?e.trim():e)},expression:"form.password"}}),"password"===s.passwordType?e("span",{staticClass:"show-password",on:{click:s.handlePassword}},[e("vab-icon",{attrs:{icon:["fas","eye-slash"]}})],1):e("span",{staticClass:"show-password",on:{click:s.handlePassword}},[e("vab-icon",{attrs:{icon:["fas","eye"]}})],1)],1),e("el-button",{staticClass:"login-btn",attrs:{loading:s.loading,type:"primary"},on:{click:s.handleLogin}},[s._v(" 登录 ")]),e("el-button",{staticStyle:{"font-size":"18px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return s.changeLoginType(1)}}},[s._v(" 切换登录方式 ")])],1)],1)],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:1==s.loginType,expression:"loginType == 1"}],staticClass:"login-main"},[e("div",{staticClass:"login-header"},[s._v(s._s(s.title))]),e("div",{staticClass:"login-body"},[e("div",{staticClass:"login-type"},[e("div",{staticClass:"login-1",class:{active:1==s.loginType},on:{click:function(e){return s.changeLoginType(1)}}},[s._v(" 扫码登陆 ")]),e("div",{staticClass:"login-line"}),e("div",{staticClass:"login-2",class:{active:2==s.loginType},on:{click:function(e){return s.changeLoginType(2)}}},[s._v(" 密码登录 ")])]),e("div",{staticClass:"login-pic"},[e("el-image",{staticStyle:{width:"208px",height:"208px"},attrs:{src:s.qrcodeImage,lazy:!0}})],1),e("div",{staticClass:"login-des"},[s._v(" 打开凌壹店面APP-样品库面板底部扫一扫二维码登录 ")])])])])}),[],!1,null,"9f6ca7b4",null);e.default=l.exports},ca48:function(s,e,t){"use strict";t("0584")}}]);