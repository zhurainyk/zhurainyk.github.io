(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8ae1fc70"],{"0a0e":function(e,t,i){},"779a":function(e,t,i){"use strict";i("0a0e")},"94c5":function(e,t,i){"use strict";i.d(t,"l",(function(){return s})),i.d(t,"m",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"p",(function(){return r})),i.d(t,"o",(function(){return d})),i.d(t,"a",(function(){return n})),i.d(t,"n",(function(){return c})),i.d(t,"f",(function(){return m})),i.d(t,"c",(function(){return p})),i.d(t,"g",(function(){return h})),i.d(t,"k",(function(){return u})),i.d(t,"i",(function(){return f})),i.d(t,"j",(function(){return y})),i.d(t,"d",(function(){return b})),i.d(t,"e",(function(){return S})),i.d(t,"h",(function(){return g}));var a=i("b775");function s(e){return Object(a.a)({url:"/admin/purchaseSheetList",method:"post",params:e})}function o(e){return Object(a.a)({url:"/supplyApp/sheetTypeList",method:"get",params:{type:3}})}function l(e){return Object(a.a)({url:"/supplyApp/purchaseSheetDelete",method:"post",params:e})}function r(){return Object(a.a)({url:"/supplyApp/supplyFactorySelectList",method:"get"})}function d(){return Object(a.a)({url:"/supplyApp/supplyAddressList",method:"get"})}function n(e){return Object(a.a)({url:"/supplyApp/purchaseSheetSave",method:"post",data:e})}function c(e){return Object(a.a)({url:"/admin/specimenGetStockPrices",method:"post",params:e})}function m(e){return Object(a.a)({url:"/supplyApp/purchaseSheetGetAddress",method:"post",params:e})}function p(e){return Object(a.a)({url:"/supplyApp/purchaseSheetDetail",method:"post",params:e})}function h(e){return Object(a.a)({url:"/supplyApp/purchaseSheetProgressUpdate",method:"post",params:e})}function u(e){return Object(a.a)({url:"/admin/purchaseSheetTimelineList",method:"post",params:e})}function f(e){return Object(a.a)({url:"/supplyApp/purchaseSheetTimelineAdd",method:"post",params:e})}function y(e){return Object(a.a)({url:"/supplyApp/purchaseSheetTimelineDelete",method:"post",params:e})}function b(e){return Object(a.a)({url:"/supplyApp/purchaseSheetExceptionHandle",method:"post",params:e})}function S(e){return Object(a.a)({url:"/supplyApp/purchaseSheetExceptionSave",method:"post",params:e})}function g(e){return Object(a.a)({url:"/supplyApp/purchaseSheetSubmitMistakeInfo",method:"post",params:e})}},d4a2:function(e,t,i){"use strict";i("caad");var a=i("daa0"),s=i("d215"),o=i("94c5"),l=i("1973"),r=i("88e3"),d=i("2dfb");const n=[{name:"specimenType",fixed:!0,ch:"样品分类"},{name:"specimenCount",fixed:!0,ch:"样品数量"}];n.push({name:"operation",fixed:"right",ch:"操作",width:250,align:"center",btnList:[{value:1,name:"选择分类样品"}]});const c=[{name:"image",fixed:!0,ch:"图片"},{name:"fullName",fixed:!0,ch:"全品名"},{name:"factoryNo",fixed:!0,ch:"货号"},{name:"pack",fixed:!0,ch:"包装"},{name:"pcsNum",fixed:!0,ch:"装箱数"},{name:"volume",fixed:!0,ch:"体积"},{name:"moq",fixed:!0,ch:"起订量"},{name:"price",fixed:!0,ch:"单价"}];var m={name:"LingyiTradeWebSelectspecimen",props:["addShow","formType"],data:()=>({lables:n,detailLables:c,disabled:!1,isShowSearch:!0,formTitle:"选择样品分类",key:"",handleSelectAddList:[],multipleSelection:[],multipleDetailSelection:[],specimenTitle:"",spceimenDetailShow:!1,specimenTypeId:"",detailKey:"",handleDetailtAddList:[],queryResultList:[]}),watch:{addShow(e){e&&(3==this.formType?this.disabled=!0:this.disabled=!1,this.specimenListSelectType())}},mounted(){},methods:{getSummaries(e){const{columns:t,data:i}=e,a=[];return t.forEach(((e,t)=>{if(2!=t)if(3==t){let e=0;this.multipleSelection.forEach((t=>{e+=Number(t.specimenCount)})),a[t]=e+"个样品"}else a[t]="";else a[t]="已选中"})),a},handleClose(){this.$emit("update:addShow",!1)},addConform(){let e=[];this.multipleSelection.forEach((t=>{e.push(t.specimenTypeId)}));const t={specimenTypeIds:e.join(",")};console.log(t),Object(l.x)(t).then((e=>{this.$emit("addConform",e)}))},specimenListSelectType(){Object(l.w)().then((e=>{e&&(this.handleSelectAddList=e)}))},handleCloseDetail(){this.spceimenDetailShow=!1},addDetailConform(){this.handleCloseDetail(),this.$emit("addConform",this.multipleDetailSelection)},specimenListSelect(){Object(l.u)().then((e=>{}))},handleSelectionChange(e){console.log(e),this.multipleSelection=e},hanldeClick(e,t){if(1==e){console.log(t),this.isShowSearch=!0,this.specimenTypeId=t.specimenTypeId,this.specimenTitle=t.specimenType,this.spceimenDetailShow=!0;const e={specimenTypeId:this.specimenTypeId};Object(l.u)(e).then((e=>{1==e.code&&(this.handleDetailtAddList=e.data.specimens)}))}},queryList(){this.spceimenDetailShow=!0,this.specimenTitle="选择样品",this.isShowSearch=!1;const e={key:this.key};Object(l.v)(e).then((e=>{1==e.code&&(this.handleDetailtAddList=e.data.specimens)}))},queryDetailList(){const e={key:this.detailKey,specimenTypeId:this.specimenTypeId};Object(l.u)(e).then((e=>{1==e.code&&(this.handleDetailtAddList=e.data.specimens)}))},handleDetailSelectionChange(e){console.log(e),this.multipleDetailSelection=e}}},p=m,h=i("2877"),u=Object(h.a)(p,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.formTitle,visible:e.addShow,"append-to-body":"",width:"60%","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.addShow=t}}},[t("div",{staticStyle:{display:"flex","justify-content":"start","align-items":"center","margin-bottom":"20px"}},[t("span",[e._v("关键字：")]),t("el-input",{staticStyle:{width:"220px","margin-right":"10px"},attrs:{placeholder:"请输入品名/工厂货号/编号搜索"},model:{value:e.key,callback:function(t){e.key=t},expression:"key"}}),t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.queryList}},[e._v("查询")])],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.handleSelectAddList,"tooltip-effect":"dark",height:"400",border:"","summary-method":e.getSummaries,"show-summary":""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",width:"45"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"index",label:"序号",fixed:"",align:"center",width:"50"}}),e._l(e.lables,(function(i,a){return t("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"card"!=i.name,label:i.ch,prop:i.name,fixed:i.fixed,width:i.width||"auto",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",["operation"==i.name?t("div",{staticStyle:{display:"flex","justify-content":"space-around"}},e._l(i.btnList,(function(i,s){return t("el-button",{key:s,attrs:{type:"text",size:"small",disabled:e.disabled},on:{click:function(t){return e.hanldeClick(i.value,a.row)}}},[e._v(e._s(i.name))])})),1):"card"==i.name?t("div",{staticClass:"demo-image__preview"},[t("el-image",{staticStyle:{width:"48px",height:"48px"},attrs:{src:a.row.card,"preview-src-list":[a.row.card]}},[t("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),t("span",{staticClass:"dot"},[e._v("...")])]),t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1):t("div",[e._v(" "+e._s(a.row[String(i.name)])+" ")])])]}}],null,!0)})}))],2),t("el-dialog",{attrs:{title:e.specimenTitle,visible:e.spceimenDetailShow,"append-to-body":"",width:"60%","close-on-click-modal":!1,"before-close":e.handleCloseDetail},on:{"update:visible":function(t){e.spceimenDetailShow=t}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowSearch,expression:"isShowSearch"}],staticStyle:{display:"flex","align-items":"center","margin-bottom":"10px"}},[t("span",[e._v("关键字：")]),t("el-input",{staticStyle:{margin:"0 10px",width:"250px"},attrs:{placeholder:"请输入品名/工厂货号/编号搜索"},model:{value:e.detailKey,callback:function(t){e.detailKey=t},expression:"detailKey"}}),t("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.queryDetailList}},[e._v("查询")])],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.handleDetailtAddList,"tooltip-effect":"dark",height:"400",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"selection",width:"45"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"index",label:"序号",fixed:"",align:"center",width:"50"}}),e._l(e.detailLables,(function(i,a){return t("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"card"!=i.name,label:i.ch,prop:i.name,fixed:i.fixed,width:i.width||"auto",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",["operation"==i.name?t("div",{staticStyle:{display:"flex","justify-content":"space-around"}}):"image"==i.name?t("div",{staticClass:"demo-image__preview"},[t("el-image",{staticStyle:{width:"48px",height:"48px"},attrs:{src:a.row.image,"preview-src-list":[a.row.image]}},[t("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),t("span",{staticClass:"dot"},[e._v("...")])]),t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1):t("div",[e._v(" "+e._s(a.row[String(i.name)])+" ")])])]}}],null,!0)})}))],2),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleCloseDetail}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addDetailConform}},[e._v("确 定")])],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addConform}},[e._v("确 定")])],1)],1)}),[],!1,null,"4c7ec0a2",null),f=u.exports,y=i("eede");const b=[{name:"image",fixed:!0,ch:"图片",width:"70"},{name:"specimenName",fixed:!0,ch:"品名",width:"150"},{name:"factoryNo",fixed:!1,ch:"货号"},{name:"customerNo",fixed:!1,ch:"客户货号"},{name:"pack",fixed:!1,ch:"包装"},{name:"color",fixex:!1,ch:"颜色"},{name:"ctnsNum",fixex:!1,ch:"箱数"},{name:"pcsNum",fixex:!1,ch:"装箱数"},{name:"price",fixex:!1,ch:"单价"},{name:"volume",fixex:!1,ch:"体积"},{name:"boxWeight",fixex:!1,ch:"毛重"},{name:"totalBoxWeight",fixex:!1,ch:"总毛重"},{name:"totalNum",fixex:!1,ch:"总数量"},{name:"totalPrice",fixex:!1,ch:"总金额"},{name:"comment",fixex:!1,ch:"备注"}],S={name:"operation",fixed:"right",ch:"操作",width:80,align:"center",btnList:[{value:1,name:"上移"},{value:2,name:"下移"},{value:3,name:"置顶"},{value:4,name:"置底"},{value:5,name:"删除"}]},g=[{name:"image",fixed:!0,ch:"图片",width:"70"}];g.push(S),b.push(S);const w={purchaseSheetId:"",orderSheetId:"",supplyFactoryId:"",factoryName:"",orderNo:"",language:"",purchaseDate:"",receiveDate:"",address:"",orderMoney:"",prePaymentDay:"",sheetTypeId:"",comment:"",frontMark:"",frontMarkImage:"",sideMark:"",sideMarkImage:"",paster:"",pasterImage:"",customerLogo:"",customerLogoImage:"",permissionType:"",permissionUserIds:"",items:[]},v={name:"",card:"",businessType:"",contractName:"",phone:"",wechat:"",qq:"",address:"",paymentDay:"",comment:"",images:"",totalEvaluateStar:0,companyScaleStar:0,payConditionStar:0,supplyFactoryId:""};var x={props:["addShow","purchaseSheetId","formType","defaultTitle","defaultForm"],mixins:[s.a,a.a],components:{selectspaciment:f},data:()=>({addressList:[],specimenId:"",index:"",supplayFactoryFormShow:!1,supplayFactoryFormTitle:"新增供应商",addSupplyFactoryForm:JSON.parse(JSON.stringify(v)),handleSelectAddList:[],imageShow:!0,lables:b,lables2:g,CustomerList:[],addForm:JSON.parse(JSON.stringify(w)),sheetTypeList:[],specimenAreaList:[],specimenTypeIds:[],primaryForm:{minPrice:"",maxPrice:"",specimenTypeIds:"",specimenAreaIds:"",specimenName:""},disabled:!1,specimenAreaIds:[],primaryShow:!1,addRules:{supplyFactoryId:[{required:!0,message:"请选择供应商",trigger:"change"}],purchaseDate:[{required:!0,message:"请选择采购日期",trigger:"change"}],receiveDate:[{required:!0,message:"请选择发货日期",trigger:"change"}],address:[{required:!0,message:"请选择收货地址",trigger:"change"}]},addNewValue:"",formLabelWidth:"120px",formInline:{priceSheetId:""},editIsDisabled:!1,selectSpecimenShow:!1,addNewShow:!1,tableInfo:{items:[]},options:[],selectTypeList:[],searchKey:"",languageList:["中文","英语","西语","阿拉伯语","俄语"],multipleSelection:[],specimenTypeList:[],formTitle:"",timerMark:null,canEditList:["factoryNo","customerNo","pack","color","ctnsNum","pcsNum","volume","boxWeight","moq","price","comment","commentImage"]}),activated(){},mounted(){this.priceSheetTypeList(),this.supplyAddressList(),this.specimenListSelectType(),this.getSpecimenAreaList()},watch:{addShow(e){this.handleSelectAddList=[],e&&1!=this.formType?2==this.formType?(this.disabled=!1,this.formTitle="编辑采购单",this.editIsDisabled=!1,this.purchaseSheetDetail({purchaseSheetId:this.purchaseSheetId},!1,!1)):3==this.formType?(this.disabled=!0,this.editIsDisabled=!0,this.formTitle="采购单详情",this.purchaseSheetDetail({purchaseSheetId:this.purchaseSheetId})):4==this.formType?(this.disabled=!1,this.editIsDisabled=!1,this.formTitle=this.defaultTitle||"复制采购单",this.permissionType=["1"],this.purchaseSheetDetail({purchaseSheetId:this.purchaseSheetId},!0)):5==this.formType&&(this.disabled=!1,this.editIsDisabled=!1,this.formTitle="添加采购单",this.permissionType=["1"],this.initForm()):e&&(this.formTitle="添加采购单",this.permissionType=["1"],this.editIsDisabled=!1,this.addForm=JSON.parse(JSON.stringify(w)),this.handleSelectAddList=[],this.orderNoAutoGenerate()),this.supplyFactorySelectList(),this.getsheetTypeList()},handleSelectAddList:{handler(e){clearTimeout(this.timerMark),this.timerMark=setTimeout((()=>{this.caculate()}),0)},deep:!0,immediate:!0}},methods:{getSummaries(e){const{columns:t,data:i}=e,a=[];return t.forEach(((e,t)=>{if(1==t)a[t]="合计";else if(7==t){let e=0;this.handleSelectAddList.forEach((t=>{e+=Number(t.ctnsNum)})),a[t]=e}else if(10==t){let e=0;this.handleSelectAddList.forEach((t=>{e+=Number(t.volume)*Number(t.ctnsNum)})),a[t]=0==e.toFixed(3)?0:e.toFixed(3)}else if(14==t){let e=0;this.handleSelectAddList.forEach((t=>{e+=Number(t.ctnsNum*t.pcsNum*t.price)})),a[t]=0==e.toFixed(3)||isNaN(e.toFixed(3))?0:e.toFixed(3)}else a[t]=""})),setTimeout((()=>{this.$nextTick((()=>{this.$refs.multipleTable.doLayout()}))})),console.log({sums:JSON.stringify(a)}),a},handleShowPictureList(e,t){this.specimenId=t.specimenId,this.index=e,this.$refs.pictureslist.listShow=!0},setMain(e){this.handleSelectAddList[this.index].image=e},getFile(e){console.log(e)},addSupplyFactory(){this.supplayFactoryFormShow=!0},addSupplyFactoryConform(e,t){e?Object(r.a)(t).then((e=>{1==e.code?(this.$message.success(e.message),this.supplayFactoryFormShow=!1,this.addSupplyFactoryForm=JSON.parse(JSON.stringify(v)),this.supplyFactorySelectList(e.data.supplyFactoryId)):this.$message.error(e.message)})):(this.supplayFactoryFormShow=!1,this.addSupplyFactoryForm=JSON.parse(JSON.stringify(v)))},getFactoryName(e){this.CustomerList.forEach((t=>{t.supplyFactoryId==e&&(this.addForm.factoryName=t.name,Object(o.f)({supplyFactoryId:t.supplyFactoryId}).then((e=>{1==e.code&&(this.addForm.address=e.data.address)})))})),console.log(this.addForm.factoryName)},supplyAddressList(){Object(o.o)().then((e=>{1==e.code&&(this.addressList=e.data.addresss)}))},caculate(){this.handleSelectAddList.forEach((e=>{e.totalNum=e.ctnsNum*Number(e.pcsNum),e.totalBoxWeight=Number(e.ctnsNum)*Number(e.boxWeight),e.totalPrice=e.ctnsNum*Number(e.pcsNum)*Number(e.price),e.totalPrice=0==e.totalPrice.toFixed(3)?0:e.totalPrice.toFixed(3)}))},initForm(){this.addForm=JSON.parse(JSON.stringify(w)),this.handleSelectAddList=[],Object.keys(this.addForm).forEach((e=>{this.defaultForm[e]&&(this.addForm[e]=this.defaultForm[e],"items"==e&&(this.defaultForm.items.forEach((e=>{e.ctnsNum=void 0===e.ctnsNum?"":e.ctnsNum})),this.handleSelectAddList.push(...this.defaultForm.items),this.orderNoAutoGenerate()))})),this.caculate()},getImgList(e,t,i){switch(console.log("图片上传",{V:e,L:t,type:i}),i){case 1:this.addForm.frontMarkImage=e;break;case 2:this.addForm.sideMarkImage=e;break;case 3:this.addForm.pasterImage=e;break;case 4:this.addForm.customerLogoImage=e}},supplyFactorySelectList(e=!1){Object(o.p)().then((t=>{1==t.code&&(this.CustomerList=t.data.items,e&&setTimeout((()=>{this.addForm.supplyFactoryId=e})))}))},getsheetTypeList(e){Object(o.m)().then((t=>{1==t.code&&(this.sheetTypeList=t.data,e&&this.sheetTypeList.forEach((t=>{t.sheetTypeId==e&&(this.addForm.sheetTypeId=e)})))}))},getSpecimenAreaList(){Object(y.g)().then((e=>{1==e.code&&(this.specimenAreaList=e.data.items)}))},orderNoAutoGenerate(){Object(d.c)().then((e=>{1==e.code&&(this.addForm.orderNo=e.data.orderNo)}))},primaryFilter(){this.primaryShow=!0},hanldeClick(e,t,i,a){let s;switch(1==a?s="handleSelectAddList":2==a&&(s="imagesList"),console.log(i),e){case 1:if(console.log("上移"),0!=i){const e=this[s].splice(i,1);this[s].splice(i-1,0,e[0])}break;case 2:if(console.log("下移"),i!=this[s].length-1){const e=this[s].splice(i,1);this[s].splice(i+1,0,e[0])}break;case 3:{console.log("置顶");const e=this[s].splice(i,1);this[s].unshift(e[0]);break}case 4:{console.log("置底");const e=this[s].splice(i,1);this[s].push(e[0]);break}case 5:console.log("删除"),this[s].splice(i,1)}},conformPrimaryFilter(e){e?(this.primaryForm.specimenTypeIds=this.specimenTypeIds.join(","),this.primaryForm.specimenAreaIds=this.specimenAreaIds.join(","),Object(l.t)(this.primaryForm).then((e=>{1==e.code?(this.$message.success(e.message),this.addConformList(e.data.specimens)):this.$message.error(e.message),this.primaryShow=!1}))):(this.primaryShow=!1,this.primaryForm.specimenTypeIds="",this.primaryForm.specimenAreaIds="",this.primaryForm.specimenName="",this.primaryForm.maxPrice="",this.primaryForm.minPrice="",this.specimenTypeIds=[],this.specimenAreaIds=[])},result:(e,t)=>["totalBoxWeight","totalNum","totalPrice"].includes(e)&&isNaN(t)?"":t,addConformList(e){e=JSON.parse(JSON.stringify(e)),this.selectSpecimenShow=!1;let t=[],i=[];e.forEach((e=>{let a=!1;this.handleSelectAddList.forEach((t=>{t.specimenId==e.specimenId&&(a=!0)})),void 0===e.commentImage&&(e.commentImage=""),a||(e.ctnsNum=void 0===e.ctnsNum?"":e.ctnsNum,t.push(e.specimenId),i.push(e))})),t.length&&Object(o.n)({specimenIds:t.join(",")}).then((e=>{1==e.code&&e.data.forEach((e=>{i.forEach((t=>{t.specimenId==e.specimenId&&(t.price=e.price,this.handleSelectAddList.push(t))}))}))})),this.caculate()},selectSpecimen(){this.selectSpecimenShow=!0},querySearchAsync(e,t){const i={key:this.searchKey};Object(l.v)(i).then((e=>{if(1==e.code){const i=e.data.specimens;i.map((e=>(e.value=e.specimenName,e))),t(i)}}))},addImg(){console.log(document.querySelector("#addimg")),document.querySelector("#addimg").click()},handleSelectAdd(e){let t=!0;e=JSON.parse(JSON.stringify(e)),this.handleSelectAddList.forEach((i=>{i.specimenId==e.specimenId&&(t=!1)})),void 0===e.commentImage&&(e.commentImage="",console.log("初始化commentImage")),t&&(e.ctnsNum=void 0===e.ctnsNum?"":e.ctnsNum,Object(o.n)({specimenIds:e.specimenId}).then((t=>{if(1==t.code){const i=t.data.find((e=>e.specimenId==e.specimenId));e.price=i.price}this.handleSelectAddList.push(e)}))),this.searchKey="",this.caculate()},handleSelectionChange(e){console.log(e),this.multipleSelection=e},conformAddNew(e){e?(this.addNewShow=!1,Object(l.r)({type:3,name:this.addNewValue}).then((e=>{1==e.code&&this.getsheetTypeList(e.data.sheetTypeId)}))):this.addNewShow=!1},priceSheetTypeList(){},specimenListSelectType(){Object(l.w)().then((e=>{e&&(this.specimenTypeList=e)}))},addNewType(){this.addNewShow=!0,this.addNewValue=""},addConform(){this.$refs.addForm.validate((e=>{if(e){if(!this.handleSelectAddList.length)return this.$message.error("请至少选择一个样品");const e=[{key:"ctnsNum",ch:"箱数",rule:/^\d+$/,isNeed:1,type:"整数"},{key:"pcsNum",ch:"装箱数",rule:/^\d+$/,isNeed:1,type:"整数"},{key:"price",ch:"单价",rule:/^(\d+)?\.?\d+$/,isNeed:0,type:"小数"},{key:"volume",ch:"体积",rule:/\d+\.?\d+/,isNeed:0,type:"小数"},{key:"boxWeight",ch:"毛重",rule:/\d+\.?\d+/,isNeed:0,type:"小数"}];if(!this.$checkRules(this.handleSelectAddList,e))return;this.addForm.items=JSON.stringify(this.handleSelectAddList),console.log("this.shareScopeEnd",this.shareScopeEnd),1==this.shareScopeEnd.toString()?this.addForm.permissionType=1:2==this.shareScopeEnd.toString()?this.addForm.permissionType=2:(this.addForm.permissionType=3,this.addForm.permissionUserIds=this.shareScopeEnd.join(",")),null==this.addForm.sheetTypeId&&(this.addForm.sheetTypeId=""),this.$emit("addConform",1,this.addForm)}}))},purchaseSheetDetail(e,t=!1,i=!0){Object(o.c)(e).then((e=>{if(1==e.code){this.addForm=e.data;let t=[];e.data.items.forEach((e=>{e.ctnsNum=void 0===e.ctnsNum?"":e.ctnsNum,t.push(e.specimenId)}));let a=e.data.items;if(t.length&&i){let e=t.join(",");Object(o.n)({specimenIds:e}).then((e=>{1==e.code&&(a.forEach((t=>{e.data.forEach((e=>{e.specimenId==t.specimenId&&(t.price=e.price)}))})),this.handleSelectAddList.push(...a))}))}else this.handleSelectAddList.push(...a)}t&&(this.orderNoAutoGenerate(),this.addForm.purchaseSheetId="",this.initPermission())}))},handleClose(){this.$emit("update:addShow",!1)}}},F=x,I=(i("779a"),Object(h.a)(F,(function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.formTitle,visible:e.addShow,"append-to-body":"",width:"80%","close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.addShow=t}}},[t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"供应商","label-width":e.formLabelWidth,prop:"supplyFactoryId"}},[t("el-select",{staticStyle:{width:"220px"},attrs:{filterable:"",placeholder:"请选择供应商",disabled:e.disabled},on:{change:e.getFactoryName},model:{value:e.addForm.supplyFactoryId,callback:function(t){e.$set(e.addForm,"supplyFactoryId",t)},expression:"addForm.supplyFactoryId"}},e._l(e.CustomerList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.supplyFactoryId}})})),1),t("i",{directives:[{name:"show",rawName:"v-show",value:!e.disabled,expression:"!disabled"}],staticClass:"el-icon-circle-plus-outline",staticStyle:{"font-size":"20px","line-height":"32px","vertical-align":"bottom","margin-left":"10px"},on:{click:e.addSupplyFactory}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"订单编号","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off",disabled:e.disabled,placeholder:"请输入订单编号"},model:{value:e.addForm.orderNo,callback:function(t){e.$set(e.addForm,"orderNo",t)},expression:"addForm.orderNo"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"采购日期","label-width":e.formLabelWidth,prop:"purchaseDate"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",disabled:e.disabled,placeholder:"选择采购日期"},model:{value:e.addForm.purchaseDate,callback:function(t){e.$set(e.addForm,"purchaseDate",t)},expression:"addForm.purchaseDate"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"发货日期","label-width":e.formLabelWidth,prop:"receiveDate"}},[t("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",disabled:e.disabled,placeholder:"选择发货日期"},model:{value:e.addForm.receiveDate,callback:function(t){e.$set(e.addForm,"receiveDate",t)},expression:"addForm.receiveDate"}})],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"收货地址","label-width":e.formLabelWidth,prop:"address"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"","allow-create":"",placeholder:"请选择收货地址",disabled:e.disabled},model:{value:e.addForm.address,callback:function(t){e.$set(e.addForm,"address",t)},expression:"addForm.address"}},e._l(e.addressList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.address,value:e.supplyAddressId}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"定金","label-width":e.formLabelWidth}},[t("el-input",{attrs:{autocomplete:"off",disabled:e.disabled,placeholder:"请输入定金"},model:{value:e.addForm.orderMoney,callback:function(t){e.$set(e.addForm,"orderMoney",t)},expression:"addForm.orderMoney"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"分类","label-width":e.formLabelWidth}},[t("div",{staticStyle:{display:"flex"}},[t("el-select",{attrs:{placeholder:"请选择分类",disabled:e.disabled},model:{value:e.addForm.sheetTypeId,callback:function(t){e.$set(e.addForm,"sheetTypeId",t)},expression:"addForm.sheetTypeId"}},e._l(e.sheetTypeList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.sheetTypeId}})})),1),t("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",disabled:e.disabled},on:{click:e.addNewType}},[e._v("新增分类")])],1)])],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea",rows:2,autocomplete:"off",disabled:e.disabled,placeholder:"请输入备注"},model:{value:e.addForm.comment,callback:function(t){e.$set(e.addForm,"comment",t)},expression:"addForm.comment"}})],1)],1)],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"withimg"},[t("el-form-item",{attrs:{label:"正唛","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea",rows:2,autocomplete:"off",disabled:e.disabled,placeholder:"请输入正唛"},model:{value:e.addForm.frontMark,callback:function(t){e.$set(e.addForm,"frontMark",t)},expression:"addForm.frontMark"}})],1),e.addShow?t("upload-img",{attrs:{value:e.addForm.frontMarkImage,dist:"orderSheet",disabled:e.disabled,multiple:!0,limit:1},on:{input:function(t){return e.getImgList(...arguments,1)}}}):e._e()],1)]),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"withimg"},[t("el-form-item",{attrs:{label:"侧唛","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea",rows:2,autocomplete:"off",disabled:e.disabled,placeholder:"请输入侧唛"},model:{value:e.addForm.sideMark,callback:function(t){e.$set(e.addForm,"sideMark",t)},expression:"addForm.sideMark"}})],1),e.addShow?t("upload-img",{attrs:{value:e.addForm.sideMarkImage,dist:"orderSheet",disabled:e.disabled,multiple:!0,limit:1},on:{input:function(t){return e.getImgList(...arguments,2)}}}):e._e()],1)])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"withimg"},[t("el-form-item",{attrs:{label:"贴纸","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea",rows:2,autocomplete:"off",disabled:e.disabled,placeholder:"请输入贴纸"},model:{value:e.addForm.paster,callback:function(t){e.$set(e.addForm,"paster",t)},expression:"addForm.paster"}})],1),e.addShow?t("upload-img",{attrs:{value:e.addForm.pasterImage,dist:"orderSheet",disabled:e.disabled,multiple:!0,limit:1},on:{input:function(t){return e.getImgList(...arguments,3)}}}):e._e()],1)]),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"withimg"},[t("el-form-item",{attrs:{label:"客版Logo","label-width":e.formLabelWidth}},[t("el-input",{attrs:{type:"textarea",rows:2,autocomplete:"off",disabled:e.disabled,placeholder:"请输入客版Logo"},model:{value:e.addForm.customerLogo,callback:function(t){e.$set(e.addForm,"customerLogo",t)},expression:"addForm.customerLogo"}})],1),e.addShow?t("upload-img",{attrs:{value:e.addForm.customerLogoImage,dist:"orderSheet",disabled:e.disabled,multiple:!0,limit:1},on:{input:function(t){return e.getImgList(...arguments,4)}}}):e._e()],1)])],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:10}},[t("el-form-item",{attrs:{label:"谁可以看","label-width":e.formLabelWidth,prop:"permissionType"}},[t("el-cascader",{attrs:{options:e.permissionTypeList,props:{multiple:!0,checkStrictly:!0,emitPath:!1},disabled:e.disabled},on:{change:e.handleChangePermissionType},model:{value:e.permissionType,callback:function(t){e.permissionType=t},expression:"permissionType"}})],1)],1)],1),t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:e.selectSpecimen}},[e._v("选择样品")]),t("el-autocomplete",{staticStyle:{"margin-left":"10px"},attrs:{disabled:e.disabled,"fetch-suggestions":e.querySearchAsync,placeholder:"请输入品名、工厂货号搜索",clearable:""},on:{select:e.handleSelectAdd},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}})],1),t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"summary-method":e.getSummaries,"show-summary":"",data:e.handleSelectAddList,"tooltip-effect":"dark",border:"",height:"400","cell-class-name":({row:e,column:t,rowIndex:i,columnIndex:a})=>(e.index=i,t.index=a)},on:{"cell-click":e.tableCellClick,"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":!0,type:"index",label:"序号",fixed:"",align:"center",width:"50"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",[e._v(e._s(i.$index+1))])]}}])}),e._l(e.lables,(function(i,a){return t("el-table-column",{key:a,attrs:{"show-overflow-tooltip":"image"!=i.name,label:i.ch,prop:i.name,fixed:i.fixed,width:i.width||"auto",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",["operation"==i.name?t("div",{staticStyle:{display:"flex","justify-content":"space-around"}},[t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 操作"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(i.btnList,(function(i,a){return t("el-dropdown-item",{key:a},[t("el-button",{attrs:{type:"text",disabled:e.disabled,size:"small"},on:{click:function(t){return e.hanldeClick(i.value,s.row,s.$index,1)}}},[e._v(" "+e._s(i.name)+" ")])],1)})),1)],1)],1):"image"==i.name?t("div",{staticClass:"demo-image__preview"},[t("el-image",{staticStyle:{width:"48px",height:"48px"},attrs:{src:s.row.image},on:{click:function(t){return e.handleShowPictureList(a,s.row)}}},[t("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[e._v(" 加载中"),t("span",{staticClass:"dot"},[e._v("...")])]),t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])])],1):s.row.index===e.tableCellClickRowIndex&&s.column.index===e.tableCellClickColumnIndex?t("span",["commentImage"!=i.name?t("el-input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{placeholder:"请输入内容…",disabled:!e.canEditList.includes(i.name)&&this.editIsDisabled,size:"mini",autofocus:""},on:{blur:e.tableCellInputBlur},model:{value:s.row[String(i.name)],callback:function(t){e.$set(s.row,String(i.name),t)},expression:"scope.row[String(item.name)]"}}):t("el-input",{attrs:{type:"file",disabled:!e.canEditList.includes(i.name)&&this.editIsDisabled,id:s.row.index+"-"+i.name,accept:"image/*",size:"mini"},on:{blur:e.tableCellInputBlur,click:function(t){return e.getFile(s.row.index+"-"+i.name)}},model:{value:s.row[String(i.name)],callback:function(t){e.$set(s.row,String(i.name),t)},expression:"scope.row[String(item.name)]"}})],1):"ctnsNum"==i.name?t("span",{staticStyle:{color:"#29d8d0","font-weight":"bold"}},[e._v(e._s(e.result(i.name,s.row[String(i.name)])))]):t("span",[e._v(e._s(e.result(i.name,s.row[String(i.name)])))])])]}}],null,!0)})}))],2),t("pictureslist",{ref:"pictureslist",attrs:{specimenId:e.specimenId},on:{setMain:e.setMain}}),t("selectspaciment",{attrs:{addShow:e.selectSpecimenShow,formType:e.formType},on:{"update:addShow":function(t){e.selectSpecimenShow=t},"update:add-show":function(t){e.selectSpecimenShow=t},addConform:e.addConformList}})],1),3!=e.formType?t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addConform}},[e._v("确 定")])],1):e._e(),t("el-dialog",{attrs:{title:"新增分类",visible:e.addNewShow,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.addNewShow=t}}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("span",[e._v("分类名称：")]),t("el-input",{staticStyle:{width:"180px"},model:{value:e.addNewValue,callback:function(t){e.addNewValue=t},expression:"addNewValue"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.conformAddNew(0)}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.conformAddNew(1)}}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:"高级筛选",visible:e.primaryShow,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.primaryShow=t}}},[t("div",{staticClass:"primaryfilter"},[t("span",[e._v("价格区间：")]),t("el-input",{staticStyle:{width:"100px"},model:{value:e.primaryForm.minPrice,callback:function(t){e.$set(e.primaryForm,"minPrice",t)},expression:"primaryForm.minPrice"}}),t("span",{staticStyle:{width:"15px","text-align":"center"}},[e._v("-")]),t("el-input",{staticStyle:{width:"100px"},model:{value:e.primaryForm.maxPrice,callback:function(t){e.$set(e.primaryForm,"maxPrice",t)},expression:"primaryForm.maxPrice"}})],1),t("div",{staticClass:"primaryfilter"},[t("span",[e._v("分类：")]),t("el-select",{attrs:{multiple:"","collapse-tags":""},model:{value:e.specimenTypeIds,callback:function(t){e.specimenTypeIds=t},expression:"specimenTypeIds"}},e._l(e.specimenTypeList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.specimenType,value:e.specimenTypeId}})})),1)],1),t("div",{staticClass:"primaryfilter"},[t("span",[e._v("销往区域：")]),t("el-select",{attrs:{multiple:"","collapse-tags":""},model:{value:e.specimenAreaIds,callback:function(t){e.specimenAreaIds=t},expression:"specimenAreaIds"}},e._l(e.specimenAreaList,(function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.specimenAreaId}})})),1)],1),t("div",{staticClass:"primaryfilter"},[t("span",[e._v("主品名：")]),t("el-input",{staticStyle:{width:"215px"},model:{value:e.primaryForm.specimenName,callback:function(t){e.$set(e.primaryForm,"specimenName",t)},expression:"primaryForm.specimenName"}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.conformPrimaryFilter(0)}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.conformPrimaryFilter(1)}}},[e._v("确 定")])],1)]),t("addform",{attrs:{addform:e.addSupplyFactoryForm,addShow:e.supplayFactoryFormShow,formTitle:e.supplayFactoryFormTitle,dist:"supplyFactory",formConfig:{label:"供应商名称",key:"name"}},on:{addConform:e.addSupplyFactoryConform}})],1)}),[],!1,null,"f51e81c6",null));t.a=I.exports}}]);